<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">

  <script>
  document.write('<base href="' + document.location + '" />')
  /* eslint-disable no-trailing-spaces, eol-last */
  </script>

  <title>_ Debugger Only _ Angular 2 Batscanner _</title>
</head>
<body>
  <!--

  -->
  <debbuger-only-demo-app></debbuger-only-demo-app>
  <!--

  -->
  <script src="../../node_modules/zone.js/dist/zone.js"></script>
  <script src="../../node_modules/reflect-metadata/Reflect.js"></script>
  <script src="../../node_modules/rxjs/bundles/Rx.js"></script>
  <script src="../../node_modules/@angular/core/bundles/core.umd.js"></script>
  <script src="../../node_modules/@angular/common/bundles/common.umd.js"></script>
  <script src="../../node_modules/@angular/compiler/bundles/compiler.umd.js"></script>
  <script src="../../node_modules/@angular/platform-browser/bundles/platform-browser.umd.js"></script>
  <script src="../../node_modules/@angular/platform-browser-dynamic/bundles/platform-browser-dynamic.umd.js"></script>
  <!--

  -->
  <!--

  -->
  <script src="../../node_modules/d3/build/d3.js"></script>
  <!--

  -->
  <script src="../../node_modules/angular-batscanner-devtool/lib/angular-batscanner-devtool.umd.js"></script>
  <!--

  -->
  <script>
  (function () {
    const {
      ng,
      Rx,
      angularBatscannerDevtool
    } = window

    const {
      Component,
      NgModule,
      ViewEncapsulation
    } = ng.core
    const {BrowserModule} = ng.platformBrowser
    const {Subject} = Rx
    const { DevToolModule } = angularBatscannerDevtool

    // //////////////////////////////////////////////////////////////////////////

    const db = [
      [
        {id: 0, targetName: 'RootComponent', type: 'OnInit'},
        {id: 0, targetName: 'RootComponent', type: 'DoCheck'},
        {id: 0, targetName: 'RootComponent', type: 'AfterContentInit'},
        {id: 0, targetName: 'RootComponent', type: 'AfterContentChecked'},
        {id: 1, targetName: 'ViewComponent', type: 'OnInit'},
        {id: 1, targetName: 'ViewComponent', type: 'DoCheck'},
        {id: 1, targetName: 'ViewComponent', type: 'AfterContentInit'},
        {id: 1, targetName: 'ViewComponent', type: 'AfterContentChecked'},
        {id: 2, targetName: 'DumbComponent', type: 'OnChanges'},
        {id: 1, targetName: 'DumbComponent', type: 'OnInit'},
        {id: 2, targetName: 'DumbComponent', type: 'DoCheck'},
        {id: 2, targetName: 'DumbComponent', type: 'AfterContentInit'},
        {id: 2, targetName: 'DumbComponent', type: 'AfterContentChecked'},
        {id: 2, targetName: 'DumbComponent', type: 'AfterViewInit'},
        {id: 2, targetName: 'DumbComponent', type: 'AfterViewChecked'},
        {id: 1, targetName: 'ViewComponent', type: 'AfterViewInit'},
        {id: 1, targetName: 'ViewComponent', type: 'AfterViewChecked'},
        {id: 0, targetName: 'RootComponent', type: 'AfterViewInit'},
        {id: 0, targetName: 'RootComponent', type: 'AfterViewChecked'}
      ],
      [
        {id: 0, targetName: 'RootComponent', type: 'DoCheck'},
        {id: 0, targetName: 'RootComponent', type: 'AfterContentChecked'},
        {id: 1, targetName: 'ViewComponent', type: 'DoCheck'},
        {id: 1, targetName: 'ViewComponent', type: 'AfterContentChecked'},
        {id: 2, targetName: 'DumbComponent', type: 'OnChanges'},
        {id: 2, targetName: 'DumbComponent', type: 'DoCheck'},
        {id: 2, targetName: 'DumbComponent', type: 'AfterContentChecked'},
        {id: 2, targetName: 'DumbComponent', type: 'AfterViewChecked'},
        {id: 1, targetName: 'ViewComponent', type: 'AfterViewChecked'},
        {id: 0, targetName: 'RootComponent', type: 'AfterViewChecked'}
      ],
      [
        {id: 0, targetName: 'RootComponent', type: 'DoCheck'},
        {id: 0, targetName: 'RootComponent', type: 'AfterContentChecked'},
        {id: 1, targetName: 'RouterOutlet', type: 'DoCheck'},
        {id: 2, targetName: 'MyRouteComponent', type: 'DoCheck'},
        {id: 2, targetName: 'MyRouteComponent', type: 'AfterContentChecked'},
        {id: 3, targetName: 'DumbComponent', type: 'OnChanges'},
        {id: 3, targetName: 'DumbComponent', type: 'DoCheck'},
        {id: 3, targetName: 'DumbComponent', type: 'AfterContentChecked'},
        {id: 3, targetName: 'DumbComponent', type: 'AfterViewChecked'},
        {id: 2, targetName: 'MyRouteComponent', type: 'AfterViewChecked'},
        {id: 1, targetName: 'RouterOutlet', type: 'AfterContentChecked'},
        {id: 1, targetName: 'RouterOutlet', type: 'AfterViewChecked'},
        {id: 0, targetName: 'RootComponent', type: 'AfterViewChecked'}
      ]
    ]

    // //////////////////////////////////////////////////////////////////////////

    const DebbugerOnlyDemoAppComponent =
    Component({
      encapsulation: ViewEncapsulation.Native,
      selector: 'debbuger-only-demo-app',
      styles: [`
      :host {
        display: flex;
        overflow: hidden;
        flex-direction: column !important;
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 0;
      }

      batscanner-debugger {
        flex: 1;
      }
      `],
      template: `
      <batscanner-debugger [state]="debuggerState$ | async"></batscanner-debugger>
      `
    })
    .Class({
      constructor: function DebbugerOnlyDemoComponentDebbugerOnlyDemoAppComponent () {
      },
      ngOnInit () {
        const self = this
        this.debuggerState$ = new Subject()
        this.done = false

        const timestamp = window.performance.now()
        let latestTimestamp = timestamp
        generateEvents(db)
        setTimeout(() => { self.done = true }, 5000)
        //

        function generateEvents (events) {
          if (self.done) {
            return
          }

          const serieIndex = Math.floor(Math.random() * events.length)
          const abstractSerie = db[serieIndex]
          const duration = 1000 + (Math.random() * 5000)

          const generatedSerie = abstractSerie.map(function (event, i) {
            const eventTimestamp = latestTimestamp
            latestTimestamp += duration
            return Object.assign({}, event, {
              duration: duration,
              end: latestTimestamp,
              start: eventTimestamp,
              timestamp: eventTimestamp
            })
          })

          self.debuggerState$.next(generatedSerie)

          const generateEventsFn = generateEvents.bind(null, events)
          setTimeout(generateEventsFn, 1000)
        }
      },

      ngOnDestroy () {
        this.done = true
        this.debuggerState$.dispose()
      }
    })

    const DebbugerOnlyDemoAppModule =
    NgModule({
      imports: [
        BrowserModule,
        DevToolModule
      ],
      declarations: [
        DebbugerOnlyDemoAppComponent
      ],
      bootstrap: [
        DebbugerOnlyDemoAppComponent
      ],
      providers: [
      ]
    })
    .Class({constructor: function DebbugerOnlyDemoAppModule () {}})

    //

    document.addEventListener('DOMContentLoaded', function () {
      ng.platformBrowserDynamic
        .platformBrowserDynamic()
        .bootstrapModule(DebbugerOnlyDemoAppModule)
    })
  }())
    /* eslint-disable no-trailing-spaces, eol-last */
  </script>
  <!--

  -->
</body>
</html>
