<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">

  <script>
  document.write('<base href="' + document.location + '" />')
  /* eslint-disable no-trailing-spaces, eol-last */
  </script>

  <title>_ Debugger Only _ Angular 2 Batscanner _</title>
</head>
<body>
  <!--

  -->
  <debbuger-only-demo-app></debbuger-only-demo-app>
  <!--

  -->
  <script src="../../node_modules/zone.js/dist/zone.js"></script>
  <script src="../../node_modules/reflect-metadata/Reflect.js"></script>
  <script src="../../node_modules/rxjs/bundles/Rx.js"></script>
  <script src="../../node_modules/@angular/core/bundles/core.umd.js"></script>
  <script src="../../node_modules/@angular/common/bundles/common.umd.js"></script>
  <script src="../../node_modules/@angular/compiler/bundles/compiler.umd.js"></script>
  <script src="../../node_modules/@angular/platform-browser/bundles/platform-browser.umd.js"></script>
  <script src="../../node_modules/@angular/platform-browser-dynamic/bundles/platform-browser-dynamic.umd.js"></script>
  <!--

  -->
  <!--

  -->
  <script src="../../node_modules/d3/build/d3.js"></script>
  <!--

  -->
  <script src="../../node_modules/angular-batscanner-devtool/lib/angular-batscanner-devtool.umd.js"></script>
  <!--

  -->
  <script>
  (function () {
    const {
      ng,
      Rx,
      angularBatscannerDevtool
    } = window

    const {
      Component,
      NgModule,
      ViewEncapsulation
    } = ng.core
    const {BrowserModule} = ng.platformBrowser
    const {Subject} = Rx
    const { DevToolModule } = angularBatscannerDevtool

////////////////////////////////////////////////////////////////////////////////

/*
[
  {
    "id": 0,
    "timestamp": 33657.125,
    "type": "DoCheck",
    "targetName": "TimerAppComponent",
    "startTime": 33657.125,
    "endTime": 33657.355,
    "duration": -0.23000000000320142
  },
  {
    "id": 0,
    "timestamp": 33657.355,
    "type": "AfterContentChecked",
    "targetName": "TimerAppComponent",
    "startTime": 33657.355,
    "endTime": 33658.30500000001,
    "duration": -0.9500000000043656
  },
  {
    "id": 1,
    "timestamp": 33657.485,
    "type": "DoCheck",
    "targetName": "DemoTimerComponent",
    "startTime": 33657.485,
    "endTime": 33657.495,
    "duration": -0.010000000002037268
  },
  {
    "id": 1,
    "timestamp": 33657.495,
    "type": "AfterContentChecked",
    "targetName": "DemoTimerComponent",
    "startTime": 33657.495,
    "endTime": 33658.30500000001,
    "duration": -0.8100000000049477
  },
  {
    "id": 2,
    "timestamp": 33658,
    "type": "OnChanges",
    "targetName": "TimerComponent",
    "changes": {
      "time": {
        "previousValue": 32,
        "currentValue": 33
      }
    },
    "startTime": 33658,
    "endTime": 33658.01,
    "duration": -0.010000000002037268
  },
  {
    "id": 2,
    "timestamp": 33658.01,
    "type": "DoCheck",
    "targetName": "TimerComponent",
    "startTime": 33658.01,
    "endTime": 33658.01500000001,
    "duration": -0.005000000004656613
  },
  {
    "id": 2,
    "timestamp": 33658.01500000001,
    "type": "AfterContentChecked",
    "targetName": "TimerComponent",
    "startTime": 33658.01500000001,
    "endTime": 33658.295000000006,
    "duration": -0.27999999999883585
  },
  {
    "id": 2,
    "timestamp": 33658.295000000006,
    "type": "AfterViewChecked",
    "targetName": "TimerComponent",
    "startTime": 33658.295000000006
  },
  {
    "id": 1,
    "timestamp": 33658.30500000001,
    "type": "AfterViewChecked",
    "targetName": "DemoTimerComponent",
    "startTime": 33658.30500000001
  },
  {
    "id": 0,
    "timestamp": 33658.30500000001,
    "type": "AfterViewChecked",
    "targetName": "TimerAppComponent",
    "startTime": 33658.30500000001
  }
]
///////////////////////////////////////////////////////////////////////////////






///////////////////////////////////////////////////////////////////////////////
  {
    "id": 0,
    "timestamp": 267796.97500000003,
    "type": "DoCheck",
    "targetName": "TimerAppComponent",
    "startTime": 267796.97500000003,
    "endTime": 278584.98500000004
  },
  {
    "id": 0,
    "timestamp": 278584.98500000004,
    "type": "AfterContentChecked",
    "targetName": "TimerAppComponent",
    "startTime": 278584.98500000004,
    "endTime": 278585.765
  },
  {
    "id": 1,
    "timestamp": 278585.04000000004,
    "type": "DoCheck",
    "targetName": "RouterOutlet",
    "startTime": 278585.04000000004,
    "endTime": 278585.755
  },
  {
    "id": 2,
    "timestamp": 278585.06500000006,
    "type": "DoCheck",
    "targetName": "DemoTimerComponent",
    "startTime": 278585.06500000006,
    "endTime": 278585.07
  },
  {
    "id": 2,
    "timestamp": 278585.07,
    "type": "AfterContentChecked",
    "targetName": "DemoTimerComponent",
    "startTime": 278585.07,
    "endTime": 278585.75
  },
  {
    "id": 3,
    "timestamp": 278585.41000000003,
    "type": "OnChanges",
    "targetName": "TimerComponent",
    "changes": {
      "time": {
        "previousValue": 227,
        "currentValue": 228
      }
    },
    "startTime": 278585.41000000003,
    "endTime": 278585.42
  },
  {
    "id": 3,
    "timestamp": 278585.42,
    "type": "DoCheck",
    "targetName": "TimerComponent",
    "startTime": 278585.42,
    "endTime": 278585.42500000005
  },
  {
    "id": 3,
    "timestamp": 278585.42500000005,
    "type": "AfterContentChecked",
    "targetName": "TimerComponent",
    "startTime": 278585.42500000005,
    "endTime": 278585.735
  },
  {
    "id": 3,
    "timestamp": 278585.735,
    "type": "AfterViewChecked",
    "targetName": "TimerComponent",
    "startTime": 278585.735
  },
  {
    "id": 2,
    "timestamp": 278585.75,
    "type": "AfterViewChecked",
    "targetName": "DemoTimerComponent",
    "startTime": 278585.75
  },
  {
    "id": 1,
    "timestamp": 278585.755,
    "type": "AfterContentChecked",
    "targetName": "RouterOutlet",
    "startTime": 278585.755,
    "endTime": 278585.76000000007
  },
  {
    "id": 1,
    "timestamp": 278585.76000000007,
    "type": "AfterViewChecked",
    "targetName": "RouterOutlet",
    "startTime": 278585.76000000007
  },
  {
    "id": 0,
    "timestamp": 278585.765,
    "type": "AfterViewChecked",
    "targetName": "TimerAppComponent",
    "startTime": 278585.765
  }
*/

    const db = [
      [
        {id: 0, targetName: 'RootComponent', type: 'DoCheck'},
        {id: 0, targetName: 'RootComponent', type: 'AfterContentChecked'},
        {id: 1, targetName: 'ViewComponent', type: 'DoCheck'},
        {id: 1, targetName: 'ViewComponent', type: 'AfterContentChecked'},
        {id: 2, targetName: 'DumbComponent', type: 'OnChanges'},
        {id: 2, targetName: 'DumbComponent', type: 'DoCheck'},
        {id: 2, targetName: 'DumbComponent', type: 'AfterContentChecked'},
        {id: 2, targetName: 'DumbComponent', type: 'AfterViewChecked'},
        {id: 1, targetName: 'ViewComponent', type: 'AfterViewChecked'},
        {id: 0, targetName: 'RootComponent', type: 'AfterViewChecked'}
      ],
      [
        {id: 0, targetName: 'RootComponent', type: 'DoCheck'},
        {id: 0, targetName: 'RootComponent', type: 'AfterContentChecked'},
        {id: 1, targetName: 'RouterOutlet', type: 'DoCheck'},
        {id: 2, targetName: 'MyRouteComponent', type: 'DoCheck'},
        {id: 2, targetName: 'MyRouteComponent', type: 'AfterContentChecked'},
        {id: 3, targetName: 'DumbComponent', type: 'OnChanges'},
        {id: 3, targetName: 'DumbComponent', type: 'DoCheck'},
        {id: 3, targetName: 'DumbComponent', type: 'AfterContentChecked'},
        {id: 3, targetName: 'DumbComponent', type: 'AfterViewChecked'},
        {id: 2, targetName: 'MyRouteComponent', type: 'AfterViewChecked'},
        {id: 1, targetName: 'RouterOutlet', type: 'AfterContentChecked'},
        {id: 1, targetName: 'RouterOutlet', type: 'AfterViewChecked'},
        {id: 0, targetName: 'RootComponent', type: 'AfterViewChecked'}
      ]
    ]

////////////////////////////////////////////////////////////////////////////////

    const DebbugerOnlyDemoAppComponent =
    Component({
      encapsulation: ViewEncapsulation.Native,
      selector: 'debbuger-only-demo-app',
      styles: [`
      :host {
        display: flex;
        overflow: hidden;
        flex-direction: column !important;
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 0;
      }

      batscanner-debugger {
        flex: 1;
      }
      `],
      template: `
      <batscanner-debugger [state]="debuggerState$ | async"></batscanner-debugger>
      `
    })
    .Class({
      constructor: function DebbugerOnlyDemoComponentDebbugerOnlyDemoAppComponent () {
      },
      ngOnInit () {
        const self = this
        this.debuggerState$ = new Subject()
        this.done = false

        generateEvents(db)

        //

        function generateEvents (events) {
          if (self.done) {
            return
          }

          const timestamp = window.performance.now()

          const serieIndex = Math.floor(Math.random() * events.length)
          const abstractSerie = db[serieIndex]
          const duration = Math.floor(Math.random() * (1000 / abstractSerie.length))

          const generatedSerie = abstractSerie.map(function (event, i) {
            return Object.assign({}, event, {
              timestamp: timestamp + (i * duration)
            })
          })

          self.debuggerState$.next(generatedSerie)

          let nextEvent = duration + 1000
          const generateEventsFn = generateEvents.bind(null, events)
          setTimeout(generateEventsFn, nextEvent)
        }
      },

      ngOnDestroy () {
        this.done = true
        this.debuggerState$.dispose()
      }
    })

    const DebbugerOnlyDemoAppModule =
    NgModule({
      imports: [
        BrowserModule,
        DevToolModule
      ],
      declarations: [
        DebbugerOnlyDemoAppComponent
      ],
      bootstrap: [
        DebbugerOnlyDemoAppComponent
      ],
      providers: [
      ]
    })
    .Class({constructor: function DebbugerOnlyDemoAppModule () {}})

    //

    document.addEventListener('DOMContentLoaded', function () {
      ng.platformBrowserDynamic
        .platformBrowserDynamic()
        .bootstrapModule(DebbugerOnlyDemoAppModule)
    })
  }())
    /* eslint-disable no-trailing-spaces, eol-last */
  </script>
  <!--

  -->
</body>
</html>
